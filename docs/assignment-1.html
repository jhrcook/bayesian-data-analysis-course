<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>5 Assignment 1 | _main</title>
  <meta name="description" content="" />
  <meta name="generator" content="bookdown 0.24 and GitBook 2.6.7" />

  <meta property="og:title" content="5 Assignment 1 | _main" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="5 Assignment 1 | _main" />
  
  
  




  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="introduction-1.html"/>
<link rel="next" href="introduction-2.html"/>
<script src="libs/header-attrs-2.10/header-attrs.js"></script>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><strong><a href="./">Notes for BDA3</a></strong></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Bayesian Data Analysis course</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#resources"><i class="fa fa-check"></i><b>1.1</b> Resources</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#how-to-study"><i class="fa fa-check"></i><b>1.2</b> How to study</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#course-sections"><i class="fa fa-check"></i><b>1.3</b> Course sections</a></li>
<li class="chapter" data-level="1.4" data-path="index.html"><a href="index.html#additional-notes"><i class="fa fa-check"></i><b>1.4</b> Additional notes</a></li>
<li class="chapter" data-level="1.5" data-path="index.html"><a href="index.html#stan-models"><i class="fa fa-check"></i><b>1.5</b> Stan models</a></li>
</ul></li>
<li class="part"><span><b>I Notes</b></span></li>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="2" data-path="section-1.-course-introduction-and-prerequisites.html"><a href="section-1.-course-introduction-and-prerequisites.html"><i class="fa fa-check"></i><b>2</b> Section 1. Course introduction and prerequisites</a>
<ul>
<li class="chapter" data-level="2.1" data-path="section-1.-course-introduction-and-prerequisites.html"><a href="section-1.-course-introduction-and-prerequisites.html#resources-1"><i class="fa fa-check"></i><b>2.1</b> Resources</a></li>
<li class="chapter" data-level="2.2" data-path="section-1.-course-introduction-and-prerequisites.html"><a href="section-1.-course-introduction-and-prerequisites.html#notes"><i class="fa fa-check"></i><b>2.2</b> Notes</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="section-1.-course-introduction-and-prerequisites.html"><a href="section-1.-course-introduction-and-prerequisites.html#reading-instructions"><i class="fa fa-check"></i><b>2.2.1</b> Reading instructions</a></li>
<li class="chapter" data-level="2.2.2" data-path="section-1.-course-introduction-and-prerequisites.html"><a href="section-1.-course-introduction-and-prerequisites.html#lecture-notes"><i class="fa fa-check"></i><b>2.2.2</b> Lecture notes</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="section-2.-basics-of-bayesian-inferences.html"><a href="section-2.-basics-of-bayesian-inferences.html"><i class="fa fa-check"></i><b>3</b> Section 2. Basics of Bayesian inferences</a>
<ul>
<li class="chapter" data-level="3.1" data-path="section-2.-basics-of-bayesian-inferences.html"><a href="section-2.-basics-of-bayesian-inferences.html#resources-2"><i class="fa fa-check"></i><b>3.1</b> Resources</a></li>
<li class="chapter" data-level="3.2" data-path="section-2.-basics-of-bayesian-inferences.html"><a href="section-2.-basics-of-bayesian-inferences.html#notes-1"><i class="fa fa-check"></i><b>3.2</b> Notes</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="section-2.-basics-of-bayesian-inferences.html"><a href="section-2.-basics-of-bayesian-inferences.html#chapter-instructions"><i class="fa fa-check"></i><b>3.2.1</b> Chapter instructions</a></li>
<li class="chapter" data-level="3.2.2" data-path="section-2.-basics-of-bayesian-inferences.html"><a href="section-2.-basics-of-bayesian-inferences.html#chapter-2.-single-parameter-models"><i class="fa fa-check"></i><b>3.2.2</b> Chapter 2. Single-parameter models</a></li>
<li class="chapter" data-level="3.2.3" data-path="section-2.-basics-of-bayesian-inferences.html"><a href="section-2.-basics-of-bayesian-inferences.html#lecture-notes-1"><i class="fa fa-check"></i><b>3.2.3</b> Lecture notes</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="section-3.-multidimensional-posterior.html"><a href="section-3.-multidimensional-posterior.html"><i class="fa fa-check"></i><b>4</b> Section 3. Multidimensional Posterior</a>
<ul>
<li class="chapter" data-level="4.1" data-path="section-3.-multidimensional-posterior.html"><a href="section-3.-multidimensional-posterior.html#resources-3"><i class="fa fa-check"></i><b>4.1</b> Resources</a></li>
<li class="chapter" data-level="4.2" data-path="section-3.-multidimensional-posterior.html"><a href="section-3.-multidimensional-posterior.html#notes-2"><i class="fa fa-check"></i><b>4.2</b> Notes</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="section-3.-multidimensional-posterior.html"><a href="section-3.-multidimensional-posterior.html#reading-instructions-1"><i class="fa fa-check"></i><b>4.2.1</b> Reading instructions</a></li>
<li class="chapter" data-level="4.2.2" data-path="section-3.-multidimensional-posterior.html"><a href="section-3.-multidimensional-posterior.html#chapter-3.-introduction-to-multiparameter-models"><i class="fa fa-check"></i><b>4.2.2</b> Chapter 3. Introduction to multiparameter models</a></li>
<li class="chapter" data-level="4.2.3" data-path="section-3.-multidimensional-posterior.html"><a href="section-3.-multidimensional-posterior.html#lecture-notes-2"><i class="fa fa-check"></i><b>4.2.3</b> Lecture notes</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>II Assignments</b></span></li>
<li class="chapter" data-level="" data-path="introduction-1.html"><a href="introduction-1.html"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="5" data-path="assignment-1.html"><a href="assignment-1.html"><i class="fa fa-check"></i><b>5</b> Assignment 1</a>
<ul>
<li class="chapter" data-level="5.1" data-path="assignment-1.html"><a href="assignment-1.html#setup"><i class="fa fa-check"></i><b>5.1</b> Setup</a></li>
<li class="chapter" data-level="5.2" data-path="assignment-1.html"><a href="assignment-1.html#exercise-1"><i class="fa fa-check"></i><b>5.2</b> Exercise 1</a></li>
<li class="chapter" data-level="5.3" data-path="assignment-1.html"><a href="assignment-1.html#exercise-3"><i class="fa fa-check"></i><b>5.3</b> Exercise 3</a></li>
<li class="chapter" data-level="5.4" data-path="assignment-1.html"><a href="assignment-1.html#exercise-4"><i class="fa fa-check"></i><b>5.4</b> Exercise 4</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="assignment-1.html"><a href="assignment-1.html#a"><i class="fa fa-check"></i><b>5.4.1</b> 4.a</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="assignment-1.html"><a href="assignment-1.html#exercise-5"><i class="fa fa-check"></i><b>5.5</b> Exercise 5</a></li>
</ul></li>
<li class="part"><span><b>III Book Exercises</b></span></li>
<li class="chapter" data-level="" data-path="introduction-2.html"><a href="introduction-2.html"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="6" data-path="chapter-1-exercises.html"><a href="chapter-1-exercises.html"><i class="fa fa-check"></i><b>6</b> Chapter 1 Exercises</a>
<ul>
<li class="chapter" data-level="6.1" data-path="chapter-1-exercises.html"><a href="chapter-1-exercises.html#question-1"><i class="fa fa-check"></i><b>6.1</b> Question 1</a></li>
<li class="chapter" data-level="6.2" data-path="chapter-1-exercises.html"><a href="chapter-1-exercises.html#question-2"><i class="fa fa-check"></i><b>6.2</b> Question 2</a></li>
<li class="chapter" data-level="6.3" data-path="chapter-1-exercises.html"><a href="chapter-1-exercises.html#question-6"><i class="fa fa-check"></i><b>6.3</b> Question 6</a></li>
<li class="chapter" data-level="6.4" data-path="chapter-1-exercises.html"><a href="chapter-1-exercises.html#question-8"><i class="fa fa-check"></i><b>6.4</b> Question 8</a></li>
</ul></li>
<li class="part"><span><b>IV About</b></span></li>
<li class="chapter" data-level="" data-path="the-website.html"><a href="the-website.html"><i class="fa fa-check"></i>The website</a></li>
<li class="chapter" data-level="" data-path="about-me.html"><a href="about-me.html"><i class="fa fa-check"></i>About me</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="_blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./"></a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="assignment-1" class="section level1" number="5">
<h1><span class="header-section-number">5</span> Assignment 1</h1>
<p>2021-08-19</p>
<p><strong><a href="assignment-01.pdf">Assignment 1</a></strong></p>
<div id="setup" class="section level2" number="5.1">
<h2><span class="header-section-number">5.1</span> Setup</h2>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="assignment-1.html#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(glue)</span></code></pre></div>
</div>
<div id="exercise-1" class="section level2" number="5.2">
<h2><span class="header-section-number">5.2</span> Exercise 1</h2>
<p><strong>(Basic probability theory notation and terms). This can be trivial or you may need to refresh your memory on these concepts. Note that some terms may be different names for the same concept. Explain each of the following terms with one sentence:</strong></p>
<ol style="list-style-type: lower-alpha">
<li>probability: how likely some assertion is to be true</li>
<li>probability mass: how likely a discrete random variable is to be some value</li>
<li>probability density: how likely a continuous random variable is to be some value</li>
<li>probability mass function (pmf): a function describing how likely a discrete random variable is to be any possible value</li>
<li>probability density function (pdf): a function describing how likely a continuous random variable is to be any possible value</li>
<li>probability distribution: a function describing how likely a random variable is to be of some value</li>
<li>discrete probability distribution: a probability distribution over discrete values</li>
<li>continuous probability distribution: a probability distribution over continuous values</li>
<li>cumulative distribution function (cdf): the cumulative sum of probabilities from a probability distribution</li>
<li>likelihood: how probable some event is under a given hypothesis</li>
</ol>
</div>
<div id="exercise-3" class="section level2" number="5.3">
<h2><span class="header-section-number">5.3</span> Exercise 3</h2>
<p><strong>(Bayes’ theorem) A group of researchers has designed a new inexpensive and painless test for detecting lung cancer.</strong>
<strong>The test is intended to be an initial screening test for the population in general.</strong>
<strong>A positive result (presence of lung cancer) from the test would be followed up immediately with medication, surgery or more extensive and expensive test.</strong>
<strong>The researchers know from their studies the following facts:</strong></p>
<ul>
<li>Test gives a positive result in 98% of the time when the test subject has lung cancer.</li>
<li>Test gives a negative result in 96 % of the time when the test subject does not have lung cancer.</li>
<li>In general population approximately 1 person in 1000 has lung cancer.</li>
</ul>
<p><strong>The researchers are happy with these preliminary results (about 97% success rate), and wish to get the test to market as soon as possible.</strong>
<strong>How would you advise them?</strong>
<strong>Base your answer on Bayes’ rule computations.</strong></p>
<p><strong>Hint: Relatively high false negative (cancer doesn’t get detected) or high false positive (unnecessarily administer medication) rates are typically bad and undesirable in tests.</strong></p>
<p><strong>Hint: Here are some probability values that can help you figure out if you copied the right conditional probabilities from the question.</strong></p>
<ul>
<li><span class="math inline">\(P(\text{Test gives positive} | \text{Subject does not have lung cancer}) = 0.04\)</span></li>
<li><span class="math inline">\(P(\text{Test gives positive and Subject has lung cancer}) = 0.00098\)</span> this is also referred to as the joint probability of test being positive and the subject having lung cancer.</li>
</ul>
<p>We are interested in the false positive and false negative rates.</p>
<p>The false positive rate, a positive test when the patient does not have cancer, is calculated below using Bayes’ rule:</p>
<p><span class="math display">\[
\Pr(\text{no cancer} | \text{positive test}) = \frac{\Pr(\text{no cancer}) \Pr(\text{positive test} | \text{no cancer})}{\Pr(\text{positive test})}
\]</span></p>
<p>Each of the components:</p>
<p><span class="math display">\[
\Pr(\text{no cancer}) = 999/1000\\
\Pr(\text{positive test} | \text{no cancer}) = 4\% = 4/100\\
\begin{aligned}
\Pr(\text{positive test}) &amp;= \Pr(\text{positive test AND cancer}) + \Pr(\text{positive test AND no cancer}) \\
&amp;= \frac{98}{100} \frac{1}{1000} + \frac{4}{100} \frac{999}{1000} = \frac{4094}{100000}
\end{aligned}
\]</span></p>
<p>thus</p>
<p><span class="math display">\[
\begin{aligned}
\Pr(\text{no cancer} | \text{positive test}) &amp;= \frac{\Pr(\text{no cancer}) \Pr(\text{positive test} | \text{no cancer})}{\Pr(\text{positive test})} \\
&amp;= \frac{\frac{999}{1000} \frac{4}{100}}{\frac{4094}{100000}} \\
&amp;= 0.976 \\
&amp;= 97.6 \%
\end{aligned}
\]</span></p>
<p>The false positive rate, a negative test when the patient does have cancer, is calculated below using Bayes’ rule:</p>
<p><span class="math display">\[
\Pr(\text{cancer} | \text{negative test}) = \frac{\Pr(\text{cancer}) \Pr(\text{negative test} | \text{cancer})}{\Pr(\text{negative test})}
\]</span></p>
<p>Each of the components:</p>
<p><span class="math display">\[
\Pr(\text{cancer}) = 1/1000\\
\Pr(\text{negative test} | \text{cancer}) = 1-0.98 = 2/100 \\
\begin{aligned}
\Pr(\text{negative test}) &amp;= \Pr(\text{negative test AND cancer}) + \Pr(\text{negative test AND no cancer}) \\
&amp;= \frac{2}{100} \frac{1}{1000} + \frac{96}{100} \frac{999}{1000} = \frac{95906}{100000}
\end{aligned}
\]</span></p>
<p>Thus,</p>
<p><span class="math display">\[
\begin{aligned}
\Pr(\text{cancer} | \text{negative test}) &amp;= \frac{\Pr(\text{cancer}) \Pr(\text{negative test} | \text{cancer})}{\Pr(\text{negative test})} \\
&amp;= \frac{\frac{1}{1000} \frac{2}{100}}{\frac{95906}{100000}} \\
&amp;= 0.0000209 \\
&amp;= 0.00209 \%
\end{aligned}
\]</span></p>
<p>The false negative rate is quite low, primarily because the cancer is relatively rare to begin with.
But, for the same reason, the false positive rate is very high.
Therefore, it could be advised that positive tests are confirmed with an independently-conducted second test or another testing procedure (e.g. CT scan).
Taking the test twice will only help if the false positive is caused by randomness and is not due to some other factor of the patient (e.g. the test is picking up some metabolite this patient produces due to their specific diet).</p>
</div>
<div id="exercise-4" class="section level2" number="5.4">
<h2><span class="header-section-number">5.4</span> Exercise 4</h2>
<p><strong>We have three boxes, A, B, and C. There are</strong></p>
<ul>
<li><strong>2 red balls and 5 white balls in the box A,</strong></li>
<li><strong>4 red balls and 1 white ball in the box B, and</strong></li>
<li><strong>1 red ball and 3 white balls in the box C.</strong></li>
</ul>
<p><strong>Consider a random experiment in which one of the boxes is randomly selected and from that box, one ball is randomly picked up.</strong>
<strong>After observing the color of the ball it is replaced in the box it came from.</strong>
<strong>Suppose also that on average box A is selected 40% of the time and box B 10% of the time (i.e. P (A) = 0.4).</strong></p>
<ol style="list-style-type: lower-alpha">
<li><strong>What is the probability of picking a red ball?</strong></li>
<li><strong>If a red ball was picked, from which box it most probably came from?</strong></li>
</ol>
<p><strong>Implement two functions in R that computes the probabilities.</strong></p>
<div id="a" class="section level3" number="5.4.1">
<h3><span class="header-section-number">5.4.1</span> 4.a</h3>
<p><span class="math display">\[
\Pr(red) = \Sigma_{b}^{boxes} \Pr(\text{red} | \text{box}_b) \Pr(\text{box}_b)
\]</span></p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="assignment-1.html#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Contents of the boxes.</span></span>
<span id="cb2-2"><a href="assignment-1.html#cb2-2" aria-hidden="true" tabindex="-1"></a>boxes <span class="ot">&lt;-</span> <span class="fu">matrix</span>(</span>
<span id="cb2-3"><a href="assignment-1.html#cb2-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">1</span>, <span class="dv">5</span>, <span class="dv">1</span>, <span class="dv">3</span>),</span>
<span id="cb2-4"><a href="assignment-1.html#cb2-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">ncol =</span> <span class="dv">2</span>,</span>
<span id="cb2-5"><a href="assignment-1.html#cb2-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">dimnames =</span> <span class="fu">list</span>(<span class="fu">c</span>(<span class="st">&quot;A&quot;</span>, <span class="st">&quot;B&quot;</span>, <span class="st">&quot;C&quot;</span>), <span class="fu">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;white&quot;</span>))</span>
<span id="cb2-6"><a href="assignment-1.html#cb2-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb2-7"><a href="assignment-1.html#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Probability of selecting each box.</span></span>
<span id="cb2-8"><a href="assignment-1.html#cb2-8" aria-hidden="true" tabindex="-1"></a>box_probs <span class="ot">&lt;-</span> <span class="fu">matrix</span>(</span>
<span id="cb2-9"><a href="assignment-1.html#cb2-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(<span class="fl">0.4</span>, <span class="fl">0.1</span>, <span class="fl">0.5</span>),</span>
<span id="cb2-10"><a href="assignment-1.html#cb2-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">ncol =</span> <span class="dv">1</span>,</span>
<span id="cb2-11"><a href="assignment-1.html#cb2-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">dimnames =</span> <span class="fu">list</span>(<span class="fu">c</span>(<span class="st">&quot;A&quot;</span>, <span class="st">&quot;B&quot;</span>, <span class="st">&quot;C&quot;</span>))</span>
<span id="cb2-12"><a href="assignment-1.html#cb2-12" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb2-13"><a href="assignment-1.html#cb2-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-14"><a href="assignment-1.html#cb2-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the probability of red per box.</span></span>
<span id="cb2-15"><a href="assignment-1.html#cb2-15" aria-hidden="true" tabindex="-1"></a>p_red_per_box <span class="ot">&lt;-</span> <span class="cf">function</span>(boxes) {</span>
<span id="cb2-16"><a href="assignment-1.html#cb2-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(boxes[, <span class="st">&quot;red&quot;</span>] <span class="sc">/</span> <span class="fu">apply</span>(boxes, <span class="dv">1</span>, sum))</span>
<span id="cb2-17"><a href="assignment-1.html#cb2-17" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb2-18"><a href="assignment-1.html#cb2-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-19"><a href="assignment-1.html#cb2-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the probability of pulling red.</span></span>
<span id="cb2-20"><a href="assignment-1.html#cb2-20" aria-hidden="true" tabindex="-1"></a>p_red <span class="ot">&lt;-</span> <span class="cf">function</span>(boxes, box_probs) {</span>
<span id="cb2-21"><a href="assignment-1.html#cb2-21" aria-hidden="true" tabindex="-1"></a>  red_probs <span class="ot">&lt;-</span> <span class="fu">p_red_per_box</span>(boxes)</span>
<span id="cb2-22"><a href="assignment-1.html#cb2-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">sum</span>(red_probs <span class="sc">*</span> box_probs))</span>
<span id="cb2-23"><a href="assignment-1.html#cb2-23" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb2-24"><a href="assignment-1.html#cb2-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-25"><a href="assignment-1.html#cb2-25" aria-hidden="true" tabindex="-1"></a>prob_red <span class="ot">&lt;-</span> <span class="fu">p_red</span>(boxes, box_probs)</span>
<span id="cb2-26"><a href="assignment-1.html#cb2-26" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">glue</span>(<span class="st">&quot;probability of red: {prob_red}&quot;</span>))</span></code></pre></div>
<pre><code>#&gt; probability of red: 0.319285714285714</code></pre>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="assignment-1.html#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the prob. that each box was used given a red ball was selected.</span></span>
<span id="cb4-2"><a href="assignment-1.html#cb4-2" aria-hidden="true" tabindex="-1"></a>p_box <span class="ot">&lt;-</span> <span class="cf">function</span>(boxes, box_probs) {</span>
<span id="cb4-3"><a href="assignment-1.html#cb4-3" aria-hidden="true" tabindex="-1"></a>  prob_red <span class="ot">&lt;-</span> <span class="fu">p_red</span>(boxes, box_probs)</span>
<span id="cb4-4"><a href="assignment-1.html#cb4-4" aria-hidden="true" tabindex="-1"></a>  red_probs <span class="ot">&lt;-</span> <span class="fu">p_red_per_box</span>(boxes)</span>
<span id="cb4-5"><a href="assignment-1.html#cb4-5" aria-hidden="true" tabindex="-1"></a>  box_probs_red <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb4-6"><a href="assignment-1.html#cb4-6" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (box <span class="cf">in</span> <span class="fu">rownames</span>(box_probs)) {</span>
<span id="cb4-7"><a href="assignment-1.html#cb4-7" aria-hidden="true" tabindex="-1"></a>    p <span class="ot">&lt;-</span> <span class="fu">unlist</span>(box_probs[box, ]) <span class="sc">*</span> <span class="fu">unlist</span>(red_probs[box]) <span class="sc">/</span> prob_red</span>
<span id="cb4-8"><a href="assignment-1.html#cb4-8" aria-hidden="true" tabindex="-1"></a>    box_probs_red <span class="ot">&lt;-</span> <span class="fu">c</span>(box_probs_red, p)</span>
<span id="cb4-9"><a href="assignment-1.html#cb4-9" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb4-10"><a href="assignment-1.html#cb4-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">names</span>(box_probs_red) <span class="ot">&lt;-</span> <span class="fu">rownames</span>(box_probs)</span>
<span id="cb4-11"><a href="assignment-1.html#cb4-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(box_probs_red)</span>
<span id="cb4-12"><a href="assignment-1.html#cb4-12" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb4-13"><a href="assignment-1.html#cb4-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-14"><a href="assignment-1.html#cb4-14" aria-hidden="true" tabindex="-1"></a>probs_of_boxes <span class="ot">&lt;-</span> <span class="fu">p_box</span>(<span class="at">boxes =</span> boxes, <span class="at">box_probs =</span> box_probs)</span>
<span id="cb4-15"><a href="assignment-1.html#cb4-15" aria-hidden="true" tabindex="-1"></a><span class="fu">stopifnot</span>(<span class="fu">sum</span>(probs_of_boxes) <span class="sc">==</span> <span class="dv">1</span>)</span>
<span id="cb4-16"><a href="assignment-1.html#cb4-16" aria-hidden="true" tabindex="-1"></a>probs_of_boxes</span></code></pre></div>
<pre><code>#&gt;         A         B         C 
#&gt; 0.3579418 0.2505593 0.3914989</code></pre>
</div>
</div>
<div id="exercise-5" class="section level2" number="5.5">
<h2><span class="header-section-number">5.5</span> Exercise 5</h2>
<p><strong>Assume that on average fraternal twins (two fertilized eggs and then could be of different sex) occur once in 150 births and identical twins (single egg divides into two separate embryos, so both have the same sex) once in 400 births (Note! This is not the true values, see Exercise 1.6, page 28, in BDA3).</strong>
<strong>American male singer-actor Elvis Presley (1935 – 1977) had a twin brother who died in birth.</strong>
<strong>Assume that an equal number of boys and girls are born on average.</strong>
<strong>What is the probability that Elvis was an identical twin?</strong>
<strong>Show the steps how you derived the equations to compute that probability.</strong></p>
<p>State the problem as a conditional probability and use Bayes’ rule to decompose into simpler terms.</p>
<p><span class="math display">\[
\begin{aligned}
\Pr(\text{Elvis was an identical twin}) &amp;= \\
\Pr(\text{identical} | \text{twin AND brother}) &amp;= \frac{\Pr(\text{identical})\Pr(\text{twin AND bro} |
\text{identical})}{\Pr(\text{twin AND bro})} \\
\end{aligned}
\]</span></p>
<p>Each component separately.</p>
<p><span class="math display">\[
\Pr(\text{identical}) = \frac{1}{400} \\
\Pr(\text{twin AND bro} | \text{identical}) = \frac{1}{2} \\
\]</span>
<span class="math display">\[
\begin{aligned}
\Pr(\text{twin AND bro}) &amp;= \Pr(\text{identical AND bro}) + \Pr(\text{fraternal AND bro}) \\
&amp;= \frac{1}{400} \frac{1}{2} + \frac{1}{150} \frac{1}{4} \\
&amp;= \frac{7}{2400} \\
\end{aligned}
\]</span></p>
<p>Thus,</p>
<p><span class="math display">\[
\Pr(\text{identical} | \text{twin AND brother}) = \frac{\frac{1}{400} \frac{1}{2}}{\frac{7}{2400}} = 0.429
\]</span></p>
<p><strong>Implement this as a function in R that computes the probability.</strong></p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="assignment-1.html#cb6-1" aria-hidden="true" tabindex="-1"></a>p_identical_twin <span class="ot">&lt;-</span> <span class="cf">function</span>(fraternal_prob, identical_prob) {</span>
<span id="cb6-2"><a href="assignment-1.html#cb6-2" aria-hidden="true" tabindex="-1"></a>  (identical_prob <span class="sc">*</span> <span class="fl">0.5</span>) <span class="sc">/</span> (identical_prob <span class="sc">*</span> <span class="fl">0.5</span> <span class="sc">+</span> fraternal_prob <span class="sc">*</span> <span class="fl">0.25</span>)</span>
<span id="cb6-3"><a href="assignment-1.html#cb6-3" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb6-4"><a href="assignment-1.html#cb6-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-5"><a href="assignment-1.html#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Tests from provided examples.</span></span>
<span id="cb6-6"><a href="assignment-1.html#cb6-6" aria-hidden="true" tabindex="-1"></a><span class="fu">stopifnot</span>(<span class="fu">round</span>(<span class="fu">p_identical_twin</span>(<span class="dv">1</span> <span class="sc">/</span> <span class="dv">125</span>, <span class="dv">1</span> <span class="sc">/</span> <span class="dv">300</span>), <span class="dv">7</span>) <span class="sc">==</span> <span class="fl">0.4545455</span>)</span>
<span id="cb6-7"><a href="assignment-1.html#cb6-7" aria-hidden="true" tabindex="-1"></a><span class="fu">stopifnot</span>(<span class="fu">round</span>(<span class="fu">p_identical_twin</span>(<span class="dv">1</span> <span class="sc">/</span> <span class="dv">100</span>, <span class="dv">1</span> <span class="sc">/</span> <span class="dv">500</span>), <span class="dv">7</span>) <span class="sc">==</span> <span class="fl">0.2857143</span>)</span>
<span id="cb6-8"><a href="assignment-1.html#cb6-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-9"><a href="assignment-1.html#cb6-9" aria-hidden="true" tabindex="-1"></a><span class="fu">p_identical_twin</span>(<span class="at">fraternal_prob =</span> <span class="dv">1</span> <span class="sc">/</span> <span class="dv">150</span>, <span class="at">identical_prob =</span> <span class="dv">1</span> <span class="sc">/</span> <span class="dv">400</span>)</span></code></pre></div>
<pre><code>#&gt; [1] 0.4285714</code></pre>

</div>
</div>



            </section>

          </div>
        </div>
      </div>
<a href="introduction-1.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="introduction-2.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/hadley/r4ds/edit/master/assignment-01.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": "https://github.com/jhrcook/bayesian-data-analysis-course/blob/master/assignment-01.Rmd",
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
