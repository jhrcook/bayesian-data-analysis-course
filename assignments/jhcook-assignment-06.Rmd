---
title: "Assignment 6"
date: "2021-10-07"
output: distill::distill_article
---

## Setup

```{r setup}
knitr::opts_chunk$set(echo = TRUE, comment = "#>", dpi = 300)

for (f in list.files(here::here("src"), pattern = "R$", full.names = TRUE)) {
  source(f)
}

library(rstan)
library(tidybayes)
library(bayesplot)
library(tidyverse)

rstan_options(auto_write = TRUE)
```

**[Assignment 6](assignments/assignment-06.pdf)**

## Exercise 1. Generalized linear model: Bioassay with Stan

**Replicate the computations for the bioassay example of section 3.7 (BDA3) using Stan.**

### 1. Write down the model for the bioassay data in Stan syntax.

**Use the Gaussian prior as in Assignment 4 and 5, that is:**

$$
\begin{bmatrix}
\alpha \\ \beta
\end{bmatrix} \sim \text{N} (\mu_0, \Sigma_0)
\quad \text{where} \quad
\mu_0 = \begin{bmatrix} 0 \\ 10 \end{bmatrix}
\quad \text{and} \quad
\Sigma_0 = \begin{bmatrix} 2^2 & 12 \\ 12 & 10^2 \end{bmatrix}
$$

**Hint!**
**You will need Stan functions `multi_normal` and `binomial_logit` for implementing the prior and observation model, respectively.**
**In Stan code, it is easiest to declare a variable (say `theta`) which is a two-element vector so that the first value denotes $\alpha$ and latter one $\beta$.**
**This is because the `multi_normal` function that you need for implementing the prior requires a vector as an input.**

```{r}
bioassay <- read_bioassay_data()
bioassay_mdl_posterior <- stan(
  file = here::here("models", "assignemt06-bioassay.stan"),
  data = list(
    N = nrow(bioassay),
    x = bioassay$x,
    n = bioassay$n,
    y = bioassay$y,
    mu = c(0, 10),
    sigma = matrix(c(2^2, 12, 12, 10^2), nrow = 2)
  )
)
```

```{r}

```






---

```{r}
sessionInfo()
```
